"use strict";var requirejs,require,define;(function(undef){var main,req,makeMap,handlers,defined={},waiting={},config={},defining={},hasOwn=Object.prototype.hasOwnProperty,aps=[].slice,jsSuffixRegExp=/\.js$/;function hasProp(obj,prop){return hasOwn.call(obj,prop)}function normalize(name,baseName){var nameParts,nameSegment,mapValue,foundMap,lastIndex,foundI,foundStarMap,starI,i,j,part,normalizedBaseParts,baseParts=baseName&&baseName.split("/"),map=config.map,starMap=map&&map["*"]||{};if(name){name=name.split("/");lastIndex=name.length-1;if(config.nodeIdCompat&&jsSuffixRegExp.test(name[lastIndex])){name[lastIndex]=name[lastIndex].replace(jsSuffixRegExp,"")}if(name[0].charAt(0)==="."&&baseParts){normalizedBaseParts=baseParts.slice(0,baseParts.length-1);name=normalizedBaseParts.concat(name)}for(i=0;i<name.length;i++){part=name[i];if(part==="."){name.splice(i,1);i-=1}else if(part===".."){if(i===0||i===1&&name[2]===".."||name[i-1]===".."){continue}else if(i>0){name.splice(i-1,2);i-=2}}}name=name.join("/")}if((baseParts||starMap)&&map){nameParts=name.split("/");for(i=nameParts.length;i>0;i-=1){nameSegment=nameParts.slice(0,i).join("/");if(baseParts){for(j=baseParts.length;j>0;j-=1){mapValue=map[baseParts.slice(0,j).join("/")];if(mapValue){mapValue=mapValue[nameSegment];if(mapValue){foundMap=mapValue;foundI=i;break}}}}if(foundMap){break}if(!foundStarMap&&starMap&&starMap[nameSegment]){foundStarMap=starMap[nameSegment];starI=i}}if(!foundMap&&foundStarMap){foundMap=foundStarMap;foundI=starI}if(foundMap){nameParts.splice(0,foundI,foundMap);name=nameParts.join("/")}}return name}function makeRequire(relName,forceSync){return function(){var args=aps.call(arguments,0);if(typeof args[0]!=="string"&&args.length===1){args.push(null)}return req.apply(undef,args.concat([relName,forceSync]))}}function makeNormalize(relName){return function(name){return normalize(name,relName)}}function makeLoad(depName){return function(value){defined[depName]=value}}function callDep(name){if(hasProp(waiting,name)){var args=waiting[name];delete waiting[name];defining[name]=true;main.apply(undef,args)}if(!hasProp(defined,name)&&!hasProp(defining,name)){throw new Error("No "+name)}return defined[name]}function splitPrefix(name){var prefix,index=name?name.indexOf("!"):-1;if(index>-1){prefix=name.substring(0,index);name=name.substring(index+1,name.length)}return[prefix,name]}function makeRelParts(relName){return relName?splitPrefix(relName):[]}makeMap=function(name,relParts){var plugin,parts=splitPrefix(name),prefix=parts[0],relResourceName=relParts[1];name=parts[1];if(prefix){prefix=normalize(prefix,relResourceName);plugin=callDep(prefix)}if(prefix){if(plugin&&plugin.normalize){name=plugin.normalize(name,makeNormalize(relResourceName))}else{name=normalize(name,relResourceName)}}else{name=normalize(name,relResourceName);parts=splitPrefix(name);prefix=parts[0];name=parts[1];if(prefix){plugin=callDep(prefix)}}return{f:prefix?prefix+"!"+name:name,n:name,pr:prefix,p:plugin}};function makeConfig(name){return function(){return config&&config.config&&config.config[name]||{}}}handlers={require:function(name){return makeRequire(name)},exports:function(name){var e=defined[name];if(typeof e!=="undefined"){return e}else{return defined[name]={}}},module:function(name){return{id:name,uri:"",exports:defined[name],config:makeConfig(name)}}};main=function(name,deps,callback,relName){var cjsModule,depName,ret,map,i,relParts,args=[],callbackType=typeof callback,usingExports;relName=relName||name;relParts=makeRelParts(relName);if(callbackType==="undefined"||callbackType==="function"){deps=!deps.length&&callback.length?["require","exports","module"]:deps;for(i=0;i<deps.length;i+=1){map=makeMap(deps[i],relParts);depName=map.f;if(depName==="require"){args[i]=handlers.require(name)}else if(depName==="exports"){args[i]=handlers.exports(name);usingExports=true}else if(depName==="module"){cjsModule=args[i]=handlers.module(name)}else if(hasProp(defined,depName)||hasProp(waiting,depName)||hasProp(defining,depName)){args[i]=callDep(depName)}else if(map.p){map.p.load(map.n,makeRequire(relName,true),makeLoad(depName),{});args[i]=defined[depName]}else{throw new Error(name+" missing "+depName)}}ret=callback?callback.apply(defined[name],args):undefined;if(name){if(cjsModule&&cjsModule.exports!==undef&&cjsModule.exports!==defined[name]){defined[name]=cjsModule.exports}else if(ret!==undef||!usingExports){defined[name]=ret}}}else if(name){defined[name]=callback}};requirejs=require=req=function(deps,callback,relName,forceSync,alt){if(typeof deps==="string"){if(handlers[deps]){return handlers[deps](callback)}return callDep(makeMap(deps,makeRelParts(callback)).f)}else if(!deps.splice){config=deps;if(config.deps){req(config.deps,config.callback)}if(!callback){return}if(callback.splice){deps=callback;callback=relName;relName=null}else{deps=undef}}callback=callback||function(){};if(typeof relName==="function"){relName=forceSync;forceSync=alt}if(forceSync){main(undef,deps,callback,relName)}else{setTimeout(function(){main(undef,deps,callback,relName)},4)}return req};req.config=function(cfg){return req(cfg)};requirejs._defined=defined;define=function(name,deps,callback){if(typeof name!=="string"){throw new Error("See almond README: incorrect module build, no module name")}if(!deps.splice){callback=deps;deps=[]}if(!hasProp(defined,name)&&!hasProp(waiting,name)){waiting[name]=[name,deps,callback]}};define.amd={jQuery:true}})();define("log-2-axis",["require","exports"],function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Log2Axis=void 0;var Scale=Chart.Scale,LinearScale=Chart.LinearScale;class Log2Axis extends Scale{constructor(cfg){super(cfg);this._startValue=undefined;this._valueRange=0}parse(raw,index){const value=LinearScale.prototype.parse.apply(this,[raw,index]);return isFinite(value)&&value>0?value:null}determineDataLimits(){const{min,max}=this.getMinMax(true);this.min=isFinite(min)?Math.max(0,min):null;this.max=isFinite(max)?Math.max(0,max):null}buildTicks(){const ticks=[];let power=Math.floor(Math.log2(this.min||1));let maxPower=Math.ceil(Math.log2(this.max||2));while(power<=maxPower){ticks.push({value:Math.pow(2,power)});power+=1}this.min=ticks[0].value;this.max=ticks[ticks.length-1].value;return ticks}configure(){const start=this.min;super.configure();this._startValue=Math.log2(start);this._valueRange=Math.log2(this.max)-Math.log2(start)}getPixelForValue(value){if(value===undefined||value===0){value=this.min}return this.getPixelForDecimal(value===this.min?0:(Math.log2(value)-this._startValue)/this._valueRange)}getValueForPixel(pixel){const decimal=this.getDecimalForPixel(pixel);return Math.pow(2,this._startValue+decimal*this._valueRange)}}exports.Log2Axis=Log2Axis;Log2Axis.id="log2";Log2Axis.defaults={}});define("chart-builder",["require","exports"],function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ScaleType=exports.Theme=exports.ChartBuilder=void 0;class ChartBuilder{constructor(canvas){this._colors=["#F94144","#F3722C","#F8961E","#F9C74F","#90BE6D","#43AA8B","#4D908E","#577590"];this._benchmarkResultRows=[];this._theme=Theme.Dark;this._yAxeTextColor="#606060";this._xAxeTextColor="#606060";this._gridLineColor="";this._creditTextColor="";this._scaleType=ScaleType.Linear;this._chart=getChart();this.theme=this.theme;function getChart(){const config={type:"bar",options:{maintainAspectRatio:false,plugins:{subtitle:{display:true,text:"Made with chartbenchmark.net",position:"right",align:"center",fullSize:false,font:{size:10,family:'SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace'}}},scales:{y:{title:{display:true}},x:{title:{display:true}}}}};return new Chart(canvas.getContext("2d"),config)}}get theme(){return this._theme}set theme(value){switch(value){case Theme.Dark:this._creditTextColor="#66666675";this._gridLineColor="#66666638";break;case Theme.Light:this._creditTextColor="#00000040";this._gridLineColor="#0000001a";break;default:break}this._theme=value;this.render()}get scaleType(){return this._scaleType}set scaleType(value){this._scaleType=value;this.render()}get chartPlugins(){return this._chart.config.options.plugins}get chartScales(){return this._chart.config.options.scales}loadBenchmarkResult(text){this._benchmarkResultRows=text.split("\n").map(i=>i.trim()).filter(i=>i.length>2&&i.startsWith("|")&&i.endsWith("|")).filter((i,index)=>index!==1).map(i=>({text:i,columns:i.split("|").slice(1,-1).map(i=>i.replace(/\*/g,"").trim())})).filter(i=>i.columns.some(c=>c.length>0));this.render()}getBenchmarkResult(){const rows=this._benchmarkResultRows;if(rows.length===0){return null}const headerRow=rows[0];const methodIndex=headerRow.columns.indexOf("Method");const runtimeIndex=headerRow.columns.indexOf("Runtime");const meanIndex=headerRow.columns.lastIndexOf("Mean");const categoryIndexStart=Math.max(methodIndex,runtimeIndex)+1;const categoryIndexEnd=meanIndex-1;const methods=new Map;for(const row of rows){if(row===headerRow){continue}let category="";for(let i=categoryIndexStart;i<=categoryIndexEnd;i++){const separator=category.length>0?", ":"";category+=`${separator}${row.columns[i]}`}const runtimeName=runtimeIndex>=0?row.columns[runtimeIndex]:null;const methodName=row.columns[methodIndex]+(runtimeName!==null?` (${runtimeName})`:"");let methodValues=methods.get(methodName);if(typeof methodValues==="undefined"){methodValues=[];methods.set(methodName,methodValues)}const valueAndScale=getValueAndScale(row.columns[meanIndex]);methodValues.push({category:category,value:valueAndScale.value,scale:valueAndScale.scale})}return{categories:getCategories(),categoriesTitle:getCategoriesTitle(),methods:getMethods(),scale:inferScale()};function getCategories(){const categories=new Set;for(const method of methods){for(const value of method[1]){categories.add(value.category)}}return[...categories]}function getCategoriesTitle(){let title="";for(let i=categoryIndexStart;i<=categoryIndexEnd;i++){const separator=title.length>0?", ":"";title+=`${separator}${headerRow.columns[i]}`}return title}function getMethods(){return[...methods].map(i=>({name:i[0],values:i[1]})).sort((a,b)=>a.name.localeCompare(b.name))}function inferScale(){for(const method of methods){for(const value of method[1]){switch(value.scale){case"us":case"μs":return"Microseconds";case"ms":return"Milliseconds";case"s":return"Seconds";default:return value.scale}}}}function getValueAndScale(formattedNumber){const scaleSeparatorIndex=formattedNumber.indexOf(" ");const scale=scaleSeparatorIndex>=0?formattedNumber.substring(scaleSeparatorIndex).trim():"";const value=parseFloat(formattedNumber.replace(/[^0-9.]/g,""));return{value:value,scale:scale}}}render(){const yAxe=this.chartScales.y;const xAxe=this.chartScales.x;const chartData=this._chart.data;const benchmarkResult=this.getBenchmarkResult();if(benchmarkResult===null){yAxe.title.text="";xAxe.title.text="";chartData.labels=[];chartData.datasets=[];this._chart.update();return}this.chartPlugins.subtitle.color=this._creditTextColor;yAxe.title.text=benchmarkResult.scale;yAxe.title.color=this._yAxeTextColor;yAxe.grid.color=this._gridLineColor;switch(this.scaleType){case ScaleType.Log10:yAxe.type="logarithmic";break;case ScaleType.Log2:yAxe.type="log2";break;default:yAxe.type="linear";break}xAxe.title.text=benchmarkResult.categoriesTitle;xAxe.title.color=this._xAxeTextColor;xAxe.grid.color=this._gridLineColor;chartData.labels=benchmarkResult.categories;const indexByCategory=new Map;for(let index=0;index<benchmarkResult.categories.length;index++){indexByCategory.set(benchmarkResult.categories[index],index)}const colors=this._colors;let colorIndex=0;chartData.datasets=benchmarkResult.methods.map(m=>({label:m.name,data:getData(m.values),backgroundColor:getNextColor()}));function getData(values){const data=new Array(indexByCategory.size);for(const value of values){const index=indexByCategory.get(value.category);if(index!==undefined){data[index]=value.value}}return data}function getNextColor(){if((colorIndex^colors.length)===0){colorIndex=0}return colors[colorIndex++]}this._chart.update()}}exports.ChartBuilder=ChartBuilder;var Theme;(function(Theme){Theme["Dark"]="dark";Theme["Light"]="light"})(Theme=exports.Theme||(exports.Theme={}));var ScaleType;(function(ScaleType){ScaleType["Linear"]="linear";ScaleType["Log10"]="log10";ScaleType["Log2"]="log2"})(ScaleType=exports.ScaleType||(exports.ScaleType={}))});define("app",["require","exports","log-2-axis","chart-builder"],function(require,exports,log_2_axis_1,chart_builder_1){"use strict";Object.defineProperty(exports,"__esModule",{value:true});class App{constructor(){Chart.register(log_2_axis_1.Log2Axis);Chart.defaults.font.family='system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue","Noto Sans","Liberation Sans",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji"';const chartWrapper=document.getElementById("chartWrapper");const chartCanvas=document.getElementById("chartCanvas");const builder=new chart_builder_1.ChartBuilder(chartCanvas);this.bindResultsInput(builder);this.bindSizeControls(chartWrapper);document.getElementById("themeRadioContainer").addEventListener("input",e=>{builder.theme=e.target.value;switch(builder.theme){case chart_builder_1.Theme.Dark:chartWrapper.classList.remove("bg-light");break;case chart_builder_1.Theme.Light:chartWrapper.classList.add("bg-light");break}});document.getElementById("scaleRadioContainer").addEventListener("input",e=>{builder.scaleType=e.target.value});document.getElementById("copyToClipboardButton").addEventListener("click",e=>{chartCanvas.toBlob(blob=>{const item=new ClipboardItem({"image/png":blob});navigator.clipboard.write([item])})});document.getElementById("downloadButton").addEventListener("click",e=>{var link=document.createElement("a");link.download="chart.png";link.href=chartCanvas.toDataURL();link.click()});document.addEventListener("readystatechange",()=>{if(document.readyState==="complete"){const widgetIFrame=document.querySelector('iframe[title*="Buy Me a Coffee"]');if(widgetIFrame!==null){widgetIFrame.setAttribute("allow","payment")}}})}bindResultsInput(builder){const resultsInput=document.getElementById("resultsInput");resultsInput.addEventListener("input",()=>{loadBenchmarkResult()});resultsInput.addEventListener("click",()=>{resultsInput.value="";loadBenchmarkResult()},{once:true});loadBenchmarkResult();function loadBenchmarkResult(){builder.loadBenchmarkResult(resultsInput.value)}}bindSizeControls(chartWrapper){const widthRangeInput=document.getElementById("widthRangeInput");const heightRangeInput=document.getElementById("heightRangeInput");if(document.body.clientWidth<992){widthRangeInput.value="1"}updateWidth();updateHeight();widthRangeInput.addEventListener("input",updateWidth);heightRangeInput.addEventListener("input",updateHeight);function updateWidth(){const value=`${parseFloat(widthRangeInput.value)*100}%`;widthRangeInput.title=value;chartWrapper.style.width=value}function updateHeight(){const value=parseFloat(heightRangeInput.value);heightRangeInput.title=`${value*100}%`;chartWrapper.style.height=`${value*1600}px`}}}new App});